# Vibe Coding Navigator - AI Development Framework

This document outlines the framework governing this AI-driven development project. It is structured as a pyramid: from high-level core principles to specific technical blueprints. The AI assistant must adhere to these rules to ensure quality, consistency, and alignment with project goals.

---

## 1. Core Principles (The "Why")

These are the foundational, non-negotiable principles that guide all local development decisions.

*   **AI-Native Philosophy**: My objective is to execute fully autonomous software development with zero human coding intervention, ensuring all generated code is controllable, reliable, and of high quality.
*   **Test-Driven Development (TDD) is Mandatory**: All functionality must be driven by tests. No production code is written before a failing test.
*   **Strict Decoupling**: Configuration values and secrets (like API keys) must be strictly decoupled from application logic. Hardcoding is forbidden.
*   **Security First**: Sensitive information (API keys, passwords) must not be committed to the code repository.
*   **Fail-Fast Protocol**: Encountering any unexpected error must lead to an immediate halt and explicit exception. Silent fails or returning default values on error are forbidden.

---

## 2. Development Workflow (The "How")

This section defines the step-by-step processes for design, implementation, and maintenance.

### 2.1. Task Management
*   All work is tracked via a Markdown task list in `docs/PROGRESS.md`.
*   I will select an unchecked `[ ]` target, mark it with `#in-progress`, and upon completion, mark it as complete `[x]`.

### 2.2. Design & Approval Workflow
*   High-level system design is documented in `docs/SYSTEM_DESIGN.md`.
*   Detailed module design is documented in `docs/MODULE_[name]_DESIGN.md`.
*   **Approval Gates**: I must halt execution and explicitly request human approval at the following project milestones:
    1.  After completing the initial `docs/SYSTEM_DESIGN.md`.
    2.  After completing the `docs/MODULE_[name]_DESIGN.md` for any new, significant module.
    3.  Before executing a major infrastructure change or a significant data migration plan.

### 2.3. Implementation Cycle (TDD)
I will strictly follow this cycle for every target:
1.  **Select Target**: Choose an unchecked target from `docs/PROGRESS.md`.
2.  **Write Tests (Test-First)**: Write complete, isolated tests. All tests against external services must use live connections.
3.  **Run Tests (Red)**: Execute the tests and confirm they fail as expected because the feature is not yet implemented.
4.  **Write Code (Green)**: Write the minimum amount of code required to make the tests pass.
5.  **Refactor**: Improve the code's structure and readability without changing its external behavior (all tests must remain green).
6.  **Update Progress**: Mark the target as complete in `docs/PROGRESS.md`.
7.  **Integration Tests**: When all of a module's targets are complete, execute its integration tests.

### 2.4. Automated Healing Protocol
When an error is encountered, I will:
1.  **Detect**: Identify the error or test failure.
2.  **Analyze**: Parse the full error message, stack trace, and relevant code.
3.  **Heal**: Isolate the root cause and patch the code.
4.  **Verify**: Re-run relevant tests to confirm the fix is effective.
5.  **Log**: Record the incident in `docs/INCIDENTS.md`.

### 2.5. Escalation Policy
I must halt execution and escalate the issue to the human developer for guidance under the following conditions:
1.  **Repetitive Failures**: After **3** consecutive failed attempts to fix the same failing test or bug.
2.  **Dependency Conflicts**: When a core dependency introduces a breaking change that causes cascading failures across multiple modules.
3.  **Ambiguous Requirements**: When the implementation for a target cannot be clearly derived from the design documents.

---

## 3. Technical Blueprint (The "What")

This section defines the concrete technical choices and structures for the project.

### 3.1. Project Structure
```
/
|-- .cursor/
|   |-- rules.mdc
|-- docs/
|   |-- adrs/
|   |-- INCIDENTS.md
|   |-- MODULE_[name]_DESIGN.md
|   |-- PROGRESS.md
|   |-- SYSTEM_DESIGN.md
|   |-- TEST_PLAN.md
|-- src/
|   |-- module_a/
|   |   |-- __init__.py
|   |   |-- feature_x.py
|   |-- module_b/
|-- tests/
|   |-- test_module_a/
|   |   |-- test_feature_x.py
|-- .env.template
|-- .gitignore
|-- README.md
|-- pyproject.toml
|-- requirements.txt   # Generated by uv
```
*   `/docs`: Contains all project management, design, and incident-log documents, including Architecture Decision Records (ADRs) in a dedicated `/adrs` subdirectory.
*   `/src`: Contains all production source code.
*   `/tests`: Contains all test code, mirroring the `/src` directory structure.

### 3.2. Technology Stack
*   **Language Policy**: The project must be implemented in either **TypeScript** or **Python**.
*   **Environment & Tooling Configuration**:
    *   **Docker**: Must use the Alibaba Cloud ACR mirror. Base images must come from the `registry.cn-hangzhou.aliyuncs.com` registry.
    *   **Python (`uv`)**: Must use the Alibaba Cloud PyPI mirror: `https://mirrors.aliyun.com/pypi/simple/`.
    *   **TypeScript (`npm` or `yarn`)**: Must use the Taobao mirror: `https://registry.npmmirror.com`.
*   **TypeScript Configuration**:
    *   **Dependency Management**: Use `package.json`. Dependencies must have explicitly pinned versions.
    *   **Compiler Options**: `tsconfig.json` must include `"strict": true`.
    *   **Linting & Formatting**: Use ESLint and Prettier.
*   **Python Configuration**:
    *   **Dependency Management**: Use `uv` for all dependency and environment management, following the declare-lock-sync workflow.
    *   **Type Hinting**: All function definitions and variables must include type hints.
    *   **Static Type Checking**: Use **Mypy** with a strict configuration (`disallow_untyped_defs = True`).
    *   **Linting & Formatting**: Use **Black** and **Ruff**.

---

## 4. Quality & Documentation Standards (The "How Well")

This section defines the standards for code quality and project documentation.

*   **Architecture Decision Records (ADRs)**: For significant technology or architectural choices, a concise ADR must be created in `/docs/adrs` to document the context and reasoning. These are records of decisions and do not require a separate approval gate.
*   **Secret Management**: Secrets must be managed via a `.env` file, which must be listed in `.gitignore`. A `.env.template` file must be maintained in the repository.
*   **Runtime Contract Enforcement**: All data from external sources must be validated at runtime (Pydantic for Python, Zod for TypeScript).
*   **Naming Conventions**: Must use descriptive names and adhere to language-specific conventions.
*   **Documentation**: All functions and classes must have comprehensive docstrings/JSDoc.
*   **Test Plan**: A `test_plan.md` must be maintained, outlining test cases and aiming for â‰¥90% coverage per target.
*   **AI-Native Principles**: The architecture must strive for High Cohesion/Loose Coupling, Self-Explanatory Code, and Contract-Driven Development.

---
**This rule set is now active. I will follow these instructions for all development tasks.** 
